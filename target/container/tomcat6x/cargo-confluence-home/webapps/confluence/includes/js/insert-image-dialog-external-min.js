AJS.toInit(function(b){var a;var c=function(e){var g=function(){return b("#insert-web-image-form",e.baseElement)},f=function(){return b("input.image-url",e.baseElement)},d=function(){f().focus()};return{getForm:g,getContainer:function(){return b(".insert-web-image",e.baseElement)},getImageInput:f,getPanel:function(){return Confluence.Templates.Image.webPanel()},bindPanelSelection:function(){e.getPanel(a).onselect=d}}};Confluence.Editor.ImageDialog.panelComponent.push({id:"external",createPanel:function(g,e){var e=(e&&e(g))||c(g),d,f,h;a=g.addPanel(AJS.I18n.getText("image.browser.web.image.title"),e.getPanel(),"web-image-panel");f=e.getForm();d=e.getContainer();h=e.getImageInput();if(g.options&&g.options.imageProperties&&g.options.imageProperties.url){g.selectPanel(a);h.val(g.options.imageProperties.url).click();f.submit()}h.bind("keyup click",function(i){var j=b(this).val();g.clearSelection();g.selectedName=j;g.allowInsert(j!=""&&j!="http://")});f.submit(function(m){var n=h.val(),l=d.find(".image-preview-area"),k=d.find(".image-preview-throbber"),j=Raphael.spinner(k[0],60,"#666"),i=d.find(".image-preview-error");k.removeClass("hidden");l.addClass("faraway");i.addClass("hidden");l.html("");b("<img>").load(function(){j();k.addClass("hidden");l.removeClass("faraway")}).error(function(){j();k.addClass("hidden");i.removeClass("hidden")}).appendTo(l).attr("src",n);m.preventDefault();return false});e.bindPanelSelection()}})});