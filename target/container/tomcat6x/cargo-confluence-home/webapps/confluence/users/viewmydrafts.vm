<html>
	<head>
		<title>$generalUtil.htmlEncode($pageTitle)</title>
    </head>

    <body>
    #requireResource("confluence.web.resources:draft-changes")

    #applyDecorator("root")
        #decoratorParam("context" "profile")
        #decoratorParam("mode" "drafts")
        #decoratorParam("helper" $action.helper)
        #decoratorParam("infopanel-width" "200px")

        <div class="view-my-drafts">
            <p>$action.getText('viewdrafts.page.desc')</p>

            <table class="tableview condensed drafts">
            #if ($drafts.isEmpty())
                <tr><td>$action.getText('no.drafts.found')</td></tr>
            #else
                <tr>
                    <th class="drafts-type">&nbsp;</th>
                    <th class="drafts-title">$action.getText('title.name')</th>
                    <th class="drafts-saved">$action.getText('last.saved.date')</th>
                    <th class="drafts-actions">$action.getText('heading.operations')</th>
                </tr>
                #foreach ($draft in $drafts)
                    <tr>
                        <td class="drafts-type">#typeIcon($draft.draftType)</td>
                        <td class="drafts-title">#if ("$!{draft.title}" != "") $!{draft.title} &nbsp; #else <em>$action.getText('untitled.draft.title')</em> #end</td>
                        <td class="drafts-saved">$generalUtil.getRelativeTime($draft.lastModificationDate)</td>
                        <td class="drafts-actions">
                            #if (!$draft.newPage)
                                <a id="view-draft-change-$draft.id" href="#" class="draftPageId:$draft.pageId draftId:$draft.id username:$remoteUser.name view-diff-link">$action.getText('view.change.upper')</a> &middot;
                            #end
                            #if ($draftManager.isMergeRequired($draft))
                                #if ($draftManager.getMergedContent($draft))
                                    <a id="merge-draft-$draft.id" href="$req.contextPath/pages/resumedraft.action?draftId=$draft.id">$action.getText('merge.and.resume')</a>
                                #else
                                    <a id="conflict-draft-$draft.id" href="$req.contextPath/pages/resumedraft.action?draftId=$draft.id">$action.getText('view.conflict')</a>
                                #end
                            #else
                                <a id="resume-draft-$draft.id" href="$req.contextPath/pages/resumedraft.action?draftId=$draft.id">$action.getText('resume.editing')</a>
                            #end &middot; <a id="discard-draft-$draft.id" href="$req.contextPath/users/deletedraft.action?draftId=$draft.id&amp;#url_xsrfToken">$action.getText('discard.name')</a>
                        </td>
                    </tr>
                #end
            #end
            </table>

        </div><!-- .view-my-drafts -->

    #end
    </body>
</html>